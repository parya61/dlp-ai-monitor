# DLP AI Monitor

–°–∏—Å—Ç–µ–º–∞ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤ —É—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö.

## –û–ø–∏—Å–∞–Ω–∏–µ

–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–æ–ø—ã—Ç–∫–∏ –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç:
- –¢–∏–ø –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞ (email, usb, cloud, printer)
- –£—Ä–æ–≤–µ–Ω—å –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏ (Low, Medium, High, Critical)
- –ù–∞–ª–∏—á–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–Ω–æ–º–µ—Ä–∞ –∫–∞—Ä—Ç, –ø–∞—Å–ø–æ—Ä—Ç–∞, –ò–ù–ù, –°–ù–ò–õ–°)
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –¥–µ–π—Å—Ç–≤–∏—è–º

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
```
–ò–Ω—Ü–∏–¥–µ–Ω—Ç 
   ‚Üì
Feature Extraction (64 –ø—Ä–∏–∑–Ω–∞–∫–∞: TF-IDF + PII + –≤—Ä–µ–º—è + –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ)
   ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  CatBoost ‚Ññ1    ‚îÇ  CatBoost ‚Ññ2    ‚îÇ
‚îÇ  –¢–∏–ø –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞  ‚îÇ  –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å    ‚îÇ
‚îÇ  100% accuracy  ‚îÇ  53% accuracy   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
   ‚Üì
PII Detector (regex –ø–æ–∏—Å–∫ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)
   ‚Üì
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (–ø—Ä–∞–≤–∏–ª–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤)
   ‚Üì
–†–µ–∑—É–ª—å—Ç–∞—Ç
```

**–û–±—É—á–µ–Ω–æ –Ω–∞ 30 000 —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö DLP-–∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤**

## –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```json
{
  "user_email": "employee@company.com",
  "recipient_email": "external@gmail.com",
  "subject": "Confidential Report",
  "body": "–ü–∞—Å–ø–æ—Ä—Ç: 1234 567890, –ö–∞—Ä—Ç–∞: 4276 3800 1234 5678",
  "attachment_names": ["report.xlsx"],
  "attachment_types": ["application/vnd.ms-excel"],
  "attachment_sizes": [2500000],
  "timestamp": "2024-01-15T14:30:00"
}
```

## –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```json
{
  "incident_type": "email",
  "incident_type_confidence": 0.9999,
  "severity": "High",
  "severity_confidence": 0.67,
  "detected_pii": ["passport", "card"],
  "pii_count": 2,
  "recommendation": "–°–†–û–ß–ù–û: –ó–∞–ø–∏—Å–∞—Ç—å –≤ –ª–æ–≥ –≤—ã—Å–æ–∫–æ–≥–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞, —É–≤–µ–¥–æ–º–∏—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞. –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ 2 PII. –û—Ç–ø—Ä–∞–≤–∫–∞ –≤–Ω–µ—à–Ω–µ–º—É –ø–æ–ª—É—á–∞—Ç–µ–ª—é - –ø–æ–≤—ã—à–µ–Ω–Ω—ã–π —Ä–∏—Å–∫.",
  "processing_time_ms": 15.5
}
```

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### Docker
```bash
git clone https://github.com/parya61/dlp-ai-monitor.git
cd dlp-ai-monitor
docker-compose up --build
```

–û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:8000/docs

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫
```bash
pip install -r requirements.txt
uvicorn api.main:app --reload --host 0.0.0.0 --port 8000
```

–û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:8000/docs

## –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
```bash
curl -X 'POST' \
  'http://localhost:8000/api/v1/predict' \
  -H 'Content-Type: application/json' \
  -d '{
  "user_email": "employee@company.com",
  "recipient_email": "competitor@external.com",
  "subject": "Confidential: Q4 Financial Report",
  "body": "–ü–∞—Å–ø–æ—Ä—Ç: 1234 567890, –ö–∞—Ä—Ç–∞: 4276 3800 1234 5678",
  "attachment_names": ["report.xlsx"],
  "timestamp": "2024-01-15T03:00:00"
}'
```
### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞
![Request Example](screen/pred.png)

### –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞
![Response Example](screen/response.png)



## üìä MLflow Tracking

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **MLflow** –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ ML.

**–ß—Ç–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è:**
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–µ–π (learning_rate, depth, iterations)
- –ú–µ—Ç—Ä–∏–∫–∏ (accuracy, F1-score, recall)
- –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏

**–ó–∞–ø—É—Å–∫:**
```bash
mlflow ui
# –û—Ç–∫—Ä–æ–π http://localhost:5000
```

![MLflow Dashboard](screen/mlflow.png)

---

## üîÑ CI/CD Pipeline

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **GitHub Actions** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è:**
- ‚úÖ –õ–∏–Ω—Ç–∏–Ω–≥ –∫–æ–¥–∞ (flake8, black)
- ‚úÖ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ (pytest)
- ‚úÖ –°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–∞
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–¢—Ä–∏–≥–≥–µ—Ä—ã:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–º `git push`

![GitHub Actions](screen/cd.png)

---

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

**Machine Learning:**
- CatBoost
- scikit-learn
- pandas, numpy
- TF-IDF

**API:**
- FastAPI
- Pydantic
- Uvicorn

**NLP:**
- spaCy
- Regex

**Infrastructure:**
- Docker
- Python 3.10

## –ú–µ—Ç—Ä–∏–∫–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| Incident Type Accuracy | 100% |
| Severity Accuracy | 53% |
| Low Severity Recall | 87% |
| Critical Severity Recall | 98% |
| Processing Time | 10-23ms |
| Training Data | 30 000 –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤ |
| Features | 64 –ø—Ä–∏–∑–Ω–∞–∫–∞ |

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
dlp-ai-monitor/
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îú‚îÄ‚îÄ schemas.py
‚îÇ   ‚îî‚îÄ‚îÄ dependencies.py
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ ml/
‚îÇ   ‚îú‚îÄ‚îÄ nlp/
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îî‚îÄ‚îÄ processed/
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ docker-compose.yml
‚îî‚îÄ‚îÄ requirements.txt
```

## –°—Ü–µ–Ω–∞—Ä–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

–°–æ—Ç—Ä—É–¥–Ω–∏–∫ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–∏—Å—å–º–æ —Å –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –≤–Ω–µ—à–Ω–µ–º—É –ø–æ–ª—É—á–∞—Ç–µ–ª—é –Ω–æ—á—å—é.

DLP —Å–∏—Å—Ç–µ–º–∞:
1. –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –ø–∏—Å—å–º–æ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
2. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ ML API
3. –ü–æ–ª—É—á–∞–µ—Ç –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—é: severity = "Critical", pii_count = 2
4. –ë–ª–æ–∫–∏—Ä—É–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫—É –∏ —É–≤–µ–¥–æ–º–ª—è–µ—Ç —Å–ª—É–∂–±—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## –ê–≤—Ç–æ—Ä

Parya - [GitHub](https://github.com/parya61)

